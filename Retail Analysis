/* List customers (full name, ID, country) who are not in the USA. */
SELECT firstname, lastname, customerid, country
FROM chinook.customers
WHERE country != 'USA';

/* List customers in Brazil. */
SELECT firstname, lastname, customerid, country
FROM chinook.customers
WHERE country = 'Brazil';

/* List the invoices of customers who are from Brazil. */
SELECT firstname, lastname, invoiceid, invoicedate, billingcountry 
FROM chinook.invoices
LEFT JOIN chinook.customers
ON customers.customerid = invoices.customerid
WHERE billingcountry = 'Brazil';

/* List all employees who are Sales Agents. */
SELECT * 
FROM chinook.employees
WHERE title = 'Sales Support Agent';

/* List unique billing countries. */
SELECT DISTINCT billingcountry
FROM invoices;

/* List the invoices associated with each sales agent. */
SELECT employees.firstname, employees.lastname, invoices.invoiceid
FROM chinook.employees
JOIN chinook.customers
ON customers.supportrepid = employees.EmployeeId
JOIN chinook.invoices
ON customers.customerid = invoices.CustomerId;

/* List invoice total, customer name, country, and sale agent for all invoices and customers. */
SELECT customers.firstname AS cust_first, customers.LastName AS cust_last, customers.Country, invoices.InvoiceId, 
invoices.Total, employees.firstname AS rep_first, employees.lastname AS rep_last
FROM chinook.employees
JOIN chinook.customers
ON customers.supportrepid = employees.EmployeeId
JOIN chinook.invoices
ON customers.customerid = invoices.CustomerId;

/* List number of invoices in 2009. */
SELECT count(*) AS inv_count
FROM chinook.invoices
WHERE invoices.InvoiceDate LIKE '2009%';

/* List total sales for 2009. */
SELECT SUM(invoices.total) AS total_sales
FROM chinook.invoices
WHERE invoices.InvoiceDate LIKE '2009%';

/* List invoice ID with purchased track name. */
SELECT invoice_items.InvoicelineId, tracks.name
FROM chinook.invoice_items
JOIN chinook.tracks
ON tracks.TrackId = invoice_items.TrackId
ORDER BY invoice_items.InvoiceLineId;
